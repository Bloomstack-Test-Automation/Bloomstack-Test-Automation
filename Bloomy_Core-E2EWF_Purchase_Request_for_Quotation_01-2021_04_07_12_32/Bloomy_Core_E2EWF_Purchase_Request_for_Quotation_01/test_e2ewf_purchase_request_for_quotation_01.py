from selenium.webdriver.common.by import By
from selenium.webdriver.support.select import Select
from src.testproject.classes import DriverStepSettings, StepSettings
from src.testproject.decorator import report_assertion_errors
from src.testproject.enums import SleepTimingType
from src.testproject.sdk.drivers import webdriver
import pytest


"""
This pytest test was automatically generated by TestProject
    Project: Bloomy_Core
    Package: TestProject.Generated.Tests.BloomyCore
    Test: E2EWF_Purchase_Request for Quotation_01
    Generated by: Rahul Prakash (rahulprakash0862@gmail.com)
    Generated on 04/07/2021, 12:32:54
"""


@pytest.fixture()
def driver():
    driver = webdriver.Chrome(token="5o-UXmLZug6gaKmDcoeI6tT7NM19XyG1qnolFybLul4",
                              project_name="Bloomy_Core",
                              job_name="E2EWF_Purchase_Request for Quotation_01")
    step_settings = StepSettings(timeout=15000,
                                 sleep_time=500,
                                 sleep_timing_type=SleepTimingType.Before)
    with DriverStepSettings(driver, step_settings):
        yield driver
    driver.quit()


@report_assertion_errors
def test_main(driver):
    """1. Go to the Request For Quotation list, click on New.

    2. Enter the date.3. Choose the Supplier to whom the Request for Quotation is to be sent.4. In the next table, enter items, quantity and the target warehouse where you'll be sending the items.5.Save and submit..
    """
    # Test Parameters
    # Auto generated application URL parameter
    ApplicationURL = "https://epitest-demo.bloomstack.io/"

    # 1. Navigate to '{ApplicationURL}'
    # Navigates the specified URL (Auto-generated)
    driver.get(f'{ApplicationURL}')

    # 2. Click 'Login'
    login = driver.find_element(By.XPATH,
                                "//a[. = 'Login']")
    login.click()

    # 3. Click 'Email Address'
    email_address = driver.find_element(By.CSS_SELECTOR,
                                        "#login_email")
    email_address.click()

    # 4. Type 'rahul.prakash@extrapreneursindia.com' in 'Email Address'
    email_address = driver.find_element(By.CSS_SELECTOR,
                                        "#login_email")
    email_address.send_keys("rahul.prakash@extrapreneursindia.com")

    # 5. Click 'Password'
    password = driver.find_element(By.CSS_SELECTOR,
                                   "#login_password")
    password.click()

    # 6. Type 'epi@123' in 'Password'
    password = driver.find_element(By.CSS_SELECTOR,
                                   "#login_password")
    password.send_keys("epi@123")

    # 7. Click 'Login1'
    login1 = driver.find_element(By.XPATH,
                                 "//button[. = '\n\t\t\t\tLogin']")
    login1.click()

    # 8. Click 'Search or type a command (Ctrl + G)'
    search_or_type_a_command_ctrl_g_ = driver.find_element(By.CSS_SELECTOR,
                                                           "#navbar-search")
    search_or_type_a_command_ctrl_g_.click()

    # 9. Type 'request' in 'Search or type a command (Ctrl + G)'
    search_or_type_a_command_ctrl_g_ = driver.find_element(By.CSS_SELECTOR,
                                                           "#navbar-search")
    search_or_type_a_command_ctrl_g_.send_keys("request")

    # 10. Click 'Request for Quotation List'
    request_for_quotation_list = driver.find_element(By.XPATH,
                                                     "//span[. = 'Request for Quotation List']")
    request_for_quotation_list.click()

    # 11. Does 'Request for Quotation2' contain 'Request for Quotation'?
    request_for_quotation2 = driver.find_element(By.XPATH,
                                                 "//div[. = 'Request for Quotation']")
    step_output = request_for_quotation2.text
    assert step_output and ("Request for Quotation" in step_output)

    # 12. Click 'New'
    new = driver.find_element(By.XPATH,
                              "//span[. = 'New']")
    new.click()

    # 13. Click 'INPUT50'
    input50 = driver.find_element(By.XPATH,
                                  "//form/div/div/div[2]/div/input")
    input50.click()

    # 14. Click 'svg5'
    svg5 = driver.find_element(By.XPATH,
                               "//div[3]/*[name()='svg']")
    svg5.click()

    # 15. Click 'svg5'
    svg5 = driver.find_element(By.XPATH,
                               "//div[3]/*[name()='svg']")
    svg5.click()

    # 16. Click '3015'
    _3015 = driver.find_element(By.XPATH,
                                "//div[32][. = '30']")
    _3015.click()

    # 17. Click 'INPUT51'
    input51 = driver.find_element(By.XPATH,
                                  "//form/div[3]//input")
    input51.click()

    # 18. Type 'vap' in 'INPUT51'
    input51 = driver.find_element(By.XPATH,
                                  "//form/div[3]//input")
    input51.send_keys("vap")

    # 19. Click 'VapeCo5'
    vapeco5 = driver.find_element(By.XPATH,
                                  "//li[. = 'VapeCo']")
    vapeco5.click()

    # 20. Does 'Request for Quotation3' contain 'Request for Quotation'?
    request_for_quotation3 = driver.find_element(By.XPATH,
                                                 "//li[2]/a[. = 'Request for Quotation']")
    step_output = request_for_quotation3.text
    assert step_output and ("Request for Quotation" in step_output)

    # 21. Click 'DIV32'
    div32 = driver.find_element(By.XPATH,
                                "//div[3]/div/div/form/div[1]/div/div[2]/div[2]/div[1]/div/div/div[2]")
    div32.click()

    # 22. Click 'P48'
    p48 = driver.find_element(By.XPATH,
                              "//div[1]/div/div/div/ul/li[2]//p")
    p48.click()

    # 23. Click 'Save20'
    save20 = driver.find_element(By.XPATH,
                                 "//span[. = 'Save']")
    save20.click()

    # 24. Scroll window by ('0','512')
    driver.execute_script("window.scrollBy(0,512)")

    # 25. Click 'Close3'
    close3 = driver.find_element(By.XPATH,
                                 "//span[. = 'Close']")
    close3.click()

    # 26. Scroll window by ('0','-200')
    driver.execute_script("window.scrollBy(0,-200)")

    # 27. Click 'DIV33'
    div33 = driver.find_element(By.XPATH,
                                "//div[4]/div/div/form/div[1]/div/div[2]/div[2]/div[1]/div/div/div[2]")
    div33.click()

    # 28. Click 'VC-RM-FO-00012'
    vc_rm_fo_00012 = driver.find_element(By.XPATH,
                                         "//strong[. = 'VC-RM-FO-0001']")
    vc_rm_fo_00012.click()

    # 29. Click 'Save22'
    save22 = driver.find_element(By.XPATH,
                                 "//button[. = 'Save']")
    save22.click()

    # 30. Scroll window by ('0','-312')
    driver.execute_script("window.scrollBy(0,-312)")

    # 31. Does 'Saved14' contain 'Saved'?
    saved14 = driver.find_element(By.XPATH,
                                  "//div[. = 'Saved']")
    step_output = saved14.text
    assert step_output and ("Saved" in step_output)

    # 32. Does 'Draft' contain 'Draft'?
    draft = driver.find_element(By.XPATH,
                                "//span/span[. = 'Draft']")
    step_output = draft.text
    assert step_output and ("Draft" in step_output)

    # 33. Click 'Submit16'
    submit16 = driver.find_element(By.XPATH,
                                   "//button/span[. = 'Submit']")
    submit16.click()

    # 34. Click 'Yes3'
    yes3 = driver.find_element(By.XPATH,
                               "//button[. = 'Yes']")
    yes3.click()

    # 35. Does 'Saved8' contain 'Saved'?
    saved8 = driver.find_element(By.XPATH,
                                 "//div[2]/div[. = 'Saved']")
    step_output = saved8.text
    assert step_output and ("Saved" in step_output)

    # 36. Does 'Submitted4' contain 'Submitted'?
    submitted4 = driver.find_element(By.XPATH,
                                     "//span/span[. = 'Submitted']")
    step_output = submitted4.text
    assert step_output and ("Submitted" in step_output)

    # 37. Click 'Supplier Quotation1'
    supplier_quotation1 = driver.find_element(By.XPATH,
                                              "//button[. = '\t\t\t\tSupplier Quotation ']")
    supplier_quotation1.click()

    # 38. Click 'Create5'
    create5 = driver.find_element(By.XPATH,
                                  "//a[. = 'Create']")
    create5.click()

    # 39. Does 'For Supplier' contain 'For Supplier'?
    for_supplier = driver.find_element(By.XPATH,
                                       "//h4[. = 'For Supplier']")
    step_output = for_supplier.text
    assert step_output and ("For Supplier" in step_output)

    # 40. Click 'Erickson-Lam'
    erickson_lam = driver.find_element(By.XPATH,
                                       "//select[. = 'Erickson-Lam']")
    erickson_lam.click()

    # 41. Select the 'Erickson-Lam' option in 'Erickson-Lam'
    erickson_lam = driver.find_element(By.XPATH,
                                       "//select[. = 'Erickson-Lam']")
    Select(erickson_lam).select_by_value("Erickson-Lam")

    # 42. Click 'Erickson-Lam'
    erickson_lam = driver.find_element(By.XPATH,
                                       "//select[. = 'Erickson-Lam']")
    erickson_lam.click()

    # 43. Click 'Create Supplier Quotation'
    create_supplier_quotation = driver.find_element(By.XPATH,
                                                    "//button[. = 'Create Supplier Quotation']")
    create_supplier_quotation.click()

    # 44. Does 'New Supplier Quotation 13' contain 'New Supplier Quotation 1'?
    new_supplier_quotation_13 = driver.find_element(By.XPATH,
                                                    "//div[. = 'New Supplier Quotation 1']")
    step_output = new_supplier_quotation_13.text
    assert step_output and ("New Supplier Quotation 1" in step_output)

    # 45. Scroll window by ('0','100')
    driver.execute_script("window.scrollBy(0,100)")

    # 46. Scroll window by ('0','200')
    driver.execute_script("window.scrollBy(0,200)")

    # 47. Click 'Save'
    save = driver.find_element(By.XPATH,
                               "//span[. = 'Save']")
    save.click()

    # 48. Scroll window by ('0','-300')
    driver.execute_script("window.scrollBy(0,-300)")

    # 49. Does 'Saved17' contain 'Saved'?
    saved17 = driver.find_element(By.XPATH,
                                  "//div[3]/div[. = 'Saved']")
    step_output = saved17.text
    assert step_output and ("Saved" in step_output)

    # 50. Click 'Submit17'
    submit17 = driver.find_element(By.XPATH,
                                   "//div[4]//button[. = 'Submit']")
    submit17.click()

    # 51. Click 'Yes4'
    yes4 = driver.find_element(By.XPATH,
                               "//div[2]/div/div//button[. = 'Yes']")
    yes4.click()

    # 52. Does 'Saved39' contain 'Saved'?
    saved39 = driver.find_element(By.XPATH,
                                  "//div[4]/div[. = 'Saved']")
    step_output = saved39.text
    assert step_output and ("Saved" in step_output)

    # 53. Click 'Create6'
    create6 = driver.find_element(By.XPATH,
                                  "//button[. = '\t\t\t\tCreate ']")
    create6.click()

    # 54. Does 'DIV36' contain '[NONE]'?
    div36 = driver.find_element(By.XPATH,
                                "//div[4]/div[1]/div/div/div[1]/h1/div[2]")
    step_output = div36.text
    assert step_output and ("" in step_output)

    # 55. Click 'Purchase Order6'
    purchase_order6 = driver.find_element(By.XPATH,
                                          "//li[1]/a[. = 'Purchase Order']")
    purchase_order6.click()

    # 56. Does 'New Purchase Order 12' contain 'New Purchase Order 1'?
    new_purchase_order_12 = driver.find_element(By.XPATH,
                                                "//div[. = 'New Purchase Order 1']")
    step_output = new_purchase_order_12.text
    assert step_output and ("New Purchase Order 1" in step_output)

    # 57. Scroll window by ('0','200')
    driver.execute_script("window.scrollBy(0,200)")

    # 58. Scroll window by ('0','100')
    driver.execute_script("window.scrollBy(0,100)")

    # 59. Scroll window by ('0','-100')
    driver.execute_script("window.scrollBy(0,-100)")

    # 60. Click 'Save1'
    save1 = driver.find_element(By.XPATH,
                                "//span[. = 'Save']")
    save1.click()

    # 61. Scroll window by ('0','-200')
    driver.execute_script("window.scrollBy(0,-200)")

    # 62. Click 'Close9'
    close9 = driver.find_element(By.XPATH,
                                 "//div[2]/div/div//button[. = '\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tClose\n\t\t\t\t\t\t\t\t']")
    close9.click()

    # 63. Click 'INPUT27'
    input27 = driver.find_element(By.XPATH,
                                  "//div[3]/div/div[2]/form/div[2]//input")
    input27.click()

    # 64. Click 'path'
    path = driver.find_element(By.XPATH,
                               "//div[5]/nav/div[3]//*[name()='path']")
    path.click()

    # 65. Click 'svg6'
    svg6 = driver.find_element(By.XPATH,
                               "//div[5]/nav/div[3]/*")
    svg6.click()

    # 66. Click '3016'
    _3016 = driver.find_element(By.XPATH,
                                "//div[5]//div[32][. = '30']")
    _3016.click()

    # 67. Click 'Save1'
    save1 = driver.find_element(By.XPATH,
                                "//span[. = 'Save']")
    save1.click()

    # 68. Does 'Saved33' contain 'Saved'?
    saved33 = driver.find_element(By.XPATH,
                                  "//div[5]/div[. = 'Saved']")
    step_output = saved33.text
    assert step_output and ("Saved" in step_output)

    # 69. Does 'Draft1' contain 'Draft'?
    draft1 = driver.find_element(By.XPATH,
                                 "//span/span[. = 'Draft']")
    step_output = draft1.text
    assert step_output and ("Draft" in step_output)

    # 70. Click 'Submit18'
    submit18 = driver.find_element(By.XPATH,
                                   "//div[5]//button[. = 'Submit']")
    submit18.click()

    # 71. Click 'Yes2'
    yes2 = driver.find_element(By.XPATH,
                               "//div[2]/div/div//button[. = 'Yes']")
    yes2.click()

    # 72. Does 'Saved40' contain 'Saved'?
    saved40 = driver.find_element(By.XPATH,
                                  "//div[7]/div[. = 'Saved']")
    step_output = saved40.text
    assert step_output and ("Saved" in step_output)

    # 73. Click 'I13'
    i13 = driver.find_element(By.XPATH,
                              "//div[5]/div[2]/div[2]/div/div[3]/div[2]/div[1]/div[3]/div/div/div[2]/div[1]/div[2]/div/div[5]/div/div/div[1]/div[1]/div[1]//i")
    i13.click()

    # 74. Does 'New Purchase Receipt 12' contain 'New Purchase Receipt 1'?
    new_purchase_receipt_12 = driver.find_element(By.XPATH,
                                                  "//div[. = 'New Purchase Receipt 1']")
    step_output = new_purchase_receipt_12.text
    assert step_output and ("New Purchase Receipt 1" in step_output)

    # 75. Click 'Save12'
    save12 = driver.find_element(By.XPATH,
                                 "//span[. = 'Save']")
    save12.click()

    # 76. Does 'Saved41' contain 'Saved'?
    saved41 = driver.find_element(By.XPATH,
                                  "//div[8]/div[. = 'Saved']")
    step_output = saved41.text
    assert step_output and ("Saved" in step_output)

    # 77. Click 'Submit13'
    submit13 = driver.find_element(By.XPATH,
                                   "//div[6]//span[. = 'Submit']")
    submit13.click()

    # 78. Click 'Yes2'
    yes2 = driver.find_element(By.XPATH,
                               "//div[2]/div/div//button[. = 'Yes']")
    yes2.click()

    # 79. Does 'Purchase Receipt has been submitted s...3' contain 'Purchase Receipt has been submitted successfully'?
    purchase_receipt_has_been_submitted_s_3 = driver.find_element(By.XPATH,
                                                                  "//div[. = 'Purchase Receipt has been submitted successfully']")
    step_output = purchase_receipt_has_been_submitted_s_3.text
    assert step_output and (
        "Purchase Receipt has been submitted successfully" in step_output)

    # 80. Click 'I9'
    i9 = driver.find_element(By.XPATH,
                             "//div[6]/div[2]/div[2]/div/div[3]/div[2]/div[1]/div[3]/div/div/div[2]/div[1]/div[2]/div/div[5]/div/div/div[1]/div[1]/div[1]//i")
    i9.click()

    # 81. Does 'New Purchase Invoice 13' contain 'New Purchase Invoice 1'?
    new_purchase_invoice_13 = driver.find_element(By.XPATH,
                                                  "//div[. = 'New Purchase Invoice 1']")
    step_output = new_purchase_invoice_13.text
    assert step_output and ("New Purchase Invoice 1" in step_output)

    # 82. Click 'SELECT17'
    select17 = driver.find_element(By.XPATH,
                                   "//div[2]/div/div[1]/form/div[3]//select")
    select17.click()

    # 83. Select the 'ACC-PINV-.YYYY.-' option in 'SELECT17'
    select17 = driver.find_element(By.XPATH,
                                   "//div[2]/div/div[1]/form/div[3]//select")
    Select(select17).select_by_value("ACC-PINV-.YYYY.-")

    # 84. Click 'SELECT17'
    select17 = driver.find_element(By.XPATH,
                                   "//div[2]/div/div[1]/form/div[3]//select")
    select17.click()

    # 85. Click 'Save13'
    save13 = driver.find_element(By.XPATH,
                                 "//span[. = 'Save']")
    save13.click()

    # 86. Does 'Saved36' contain 'Saved'?
    saved36 = driver.find_element(By.XPATH,
                                  "//div[11]/div[. = 'Saved']")
    step_output = saved36.text
    assert step_output and ("Saved" in step_output)

    # 87. Does 'Purchase Invoice2' contain 'Purchase Invoice'?
    purchase_invoice2 = driver.find_element(By.XPATH,
                                            "//li[2]/a[. = 'Purchase Invoice']")
    step_output = purchase_invoice2.text
    assert step_output and ("Purchase Invoice" in step_output)

    # 88. Click 'Submit3'
    submit3 = driver.find_element(By.XPATH,
                                  "//div[7]//span[. = 'Submit']")
    submit3.click()

    # 89. Click 'Yes2'
    yes2 = driver.find_element(By.XPATH,
                               "//div[2]/div/div//button[. = 'Yes']")
    yes2.click()

    # 90. Does 'Purchase Invoice has been submitted s...2' contain 'Purchase Invoice has been submitted successfully'?
    purchase_invoice_has_been_submitted_s_2 = driver.find_element(By.XPATH,
                                                                  "//div[. = 'Purchase Invoice has been submitted successfully']")
    step_output = purchase_invoice_has_been_submitted_s_2.text
    assert step_output and (
        "Purchase Invoice has been submitted successfully" in step_output)

    # 91. Click '6'
    _6 = driver.find_element(By.XPATH,
                             "//div[7]/div[2]/div[2]/div/div[3]/div[2]/div[1]/div[3]/div/div/div[2]/div[1]/div[2]/div/div[5]/div/div/div[1]/div[1]/div[1]/button[. = '        ']")
    _6.click()

    # 92. Does 'New Payment Entry 12' contain 'New Payment Entry 1'?
    new_payment_entry_12 = driver.find_element(By.XPATH,
                                               "//div[. = 'New Payment Entry 1']")
    step_output = new_payment_entry_12.text
    assert step_output and ("New Payment Entry 1" in step_output)

    # 93. Click 'INPUT52'
    input52 = driver.find_element(By.XPATH,
                                  "//div[3]/div[2]/div[2]/form/div[3]//input")
    input52.click()

    # 94. Type 'Cas' in 'INPUT52'
    input52 = driver.find_element(By.XPATH,
                                  "//div[3]/div[2]/div[2]/form/div[3]//input")
    input52.send_keys("Cas")

    # 95. Click 'Cash4'
    cash4 = driver.find_element(By.XPATH,
                                "//p[. = 'Cash']")
    cash4.click()

    # 96. Click 'Save14'
    save14 = driver.find_element(By.XPATH,
                                 "//button[. = 'Save']")
    save14.click()

    # 97. Does 'Saved42' contain 'Saved'?
    saved42 = driver.find_element(By.XPATH,
                                  "//div[14]/div[. = 'Saved']")
    step_output = saved42.text
    assert step_output and ("Saved" in step_output)

    # 98. Does 'Draft6' contain 'Draft'?
    draft6 = driver.find_element(By.XPATH,
                                 "//span/span[. = 'Draft']")
    step_output = draft6.text
    assert step_output and ("Draft" in step_output)

    # 99. Click 'Submit8'
    submit8 = driver.find_element(By.XPATH,
                                  "//div[8]//span[. = 'Submit']")
    submit8.click()

    # 100. Click 'Yes2'
    yes2 = driver.find_element(By.XPATH,
                               "//div[2]/div/div//button[. = 'Yes']")
    yes2.click()

    # 101. Does 'Saved43' contain 'Saved'?
    saved43 = driver.find_element(By.XPATH,
                                  "//div[15]/div[. = 'Saved']")
    step_output = saved43.text
    assert step_output and ("Saved" in step_output)

    # 102. Does 'Submitted5' contain 'Submitted'?
    submitted5 = driver.find_element(By.XPATH,
                                     "//div[8]/div[1]/div/div/div[1]/h1/div[2]/span/span[. = 'Submitted']")
    step_output = submitted5.text
    assert step_output and ("Submitted" in step_output)

    # 103. Click 'Settings'
    settings = driver.find_element(By.XPATH,
                                   "//span[. = '      Settings']")
    settings.click()

    # 104. Click 'Logout'
    logout = driver.find_element(By.XPATH,
                                 "//a[. = '       Logout']")
    logout.click()
